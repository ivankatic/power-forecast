(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{116:function(e,t,a){e.exports=a(242)},124:function(e,t,a){},242:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(16),o=a.n(r),s=a(8),c=a(6),i=a(20),u=a(21),m=a(23),d=a(22),p=(a(124),a(39)),b=a(244),f=a(243),y=a(246),h=function(e){var t={};return(!e.latitude||e.latitude<-90||e.latitude>90||isNaN(Number(e.latitude)))&&(t.latitude="Please enter a number between -90 and 90."),(!e.longitude||e.longitude<-180||e.longitude>180||isNaN(Number(e.longitude)))&&(t.longitude="Please enter a number between -180 and 180."),(!e.capacity||e.capacity<0||isNaN(Number(e.capacity)))&&(t.capacity="Please enter a number greater than zero."),(!e.azimuth||e.azimuth<-180||e.azimuth>180||isNaN(Number(e.azimuth)))&&(t.azimuth="Please enter a number between -180 and 180."),(!e.tilt||e.tilt<0||e.tilt>90||isNaN(Number(e.tilt)))&&(t.tilt="Please enter a number between -0 and 90."),t},v=function(e){var t=e.input,a=e.label,n=e.className,r=e.placeholder,o=e.type,s=e.meta,c=s.touched,i=s.error,u=e.disabled;return l.a.createElement("div",null,l.a.createElement("label",null,a),l.a.createElement("div",null,l.a.createElement("input",Object.assign({},t,{autoComplete:"off",placeholder:r,type:o,disabled:u,className:n})),c&&i&&l.a.createElement("span",{className:"text-input__error"},i)))},g=Object(f.a)({form:"wizard",destroyOnUnmount:!1,validate:h})((function(e){var t=e.handleSubmit,a=e.showModal,n=e.disableLatLng,r=e.manualLatLng,o=e.lat,s=e.lng;return l.a.createElement("form",{onSubmit:t},l.a.createElement("div",{className:"box__content"},l.a.createElement("p",{className:"box__instructions"},"Please select the power system location"),l.a.createElement("button",{type:"button",className:"button--wide",onClick:function(e){a(e)}},"Select on map"),l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"latitude",type:"text",component:v,label:"Latitude",disabled:n,placeholder:"".concat(n?o:"Enter latitude"),className:"text-input"})),l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"longitude",type:"text",component:v,label:"Longitude",disabled:n,placeholder:"".concat(n?s:"Enter longitude"),className:"text-input"})),l.a.createElement("div",{className:"manual"},l.a.createElement("input",{type:"checkbox",id:"manual",name:"manual",className:"manual__checkbox"}),l.a.createElement("label",{htmlFor:"manual",className:"manual__label",onClick:r},l.a.createElement("span",{className:"manual__checkbox-button"}),"Enter latitude and longitude manually"))),l.a.createElement("button",{type:"submit",className:"button--wide u-side-padding next"},"Next"))})),E=Object(y.a)("latitude"),N=Object(s.b)((function(e){return{latitude:E(e,"latitude"),longitude:E(e,"longitude")}}))(g),_=a(35),O=a.n(_),x=a(53),w=a(112),T=a.n(w).a.create({baseURL:"https://api.solcast.com.au",headers:{Authorization:"Bearer oPQNBwt1v6bXPb5he-out_XYYfm_aVRg"}}),j=a(12),L=Object(j.a)(),k=Object(f.a)({form:"wizard",destroyOnUnmount:!1,validate:h})((function(e){var t=e.handleSubmit,a=e.previousPage,n=e.pristine,r=e.submitting;return l.a.createElement("form",{onSubmit:t((function(t){e.fetchForecast(t)})),className:"form"},l.a.createElement("div",{className:"box__content"},l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"capacity",type:"text",component:v,label:"Capacity (kW)",className:"text-input"})),l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"tilt",type:"text",component:v,label:"Tilt",className:"text-input"})),l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"azimuth",type:"text",component:v,label:"Azimuth",className:"text-input"})),l.a.createElement("div",{className:"input-col"},l.a.createElement(b.a,{name:"date",type:"date",component:v,label:"Installation Date",className:"text-input"}))),l.a.createElement("button",{type:"button",onClick:a,className:"button--wide u-side-padding previous"},"Back"),l.a.createElement("button",{type:"submit",className:"button--wide u-side-padding",disabled:n||r},"Calculate"))})),C=Object(s.b)((function(e){}),{fetchForecast:function(e){var t=e.latitude,a=e.longitude,n=e.capacity,l=e.tilt,r=e.azimuth,o=e.install_date;return function(){var e=Object(x.a)(O.a.mark((function e(s){var c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.get("/world_pv_power/forecasts?format=json",{params:{latitude:t,longitude:a,capacity:n,tilt:l,azimuth:r,install_date:o,hours:168}});case 2:c=e.sent,s({type:"FETCH_FORECAST",payload:c.data.forecasts}),L.push("/forecast");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(k),S=a(115),P=a(56),z=a(55),D=a(42);a(240);function M(e){var t=e.panTo,a=Object(z.a)(),n=a.ready,r=a.value,o=a.suggestions,s=o.status,c=o.data,i=a.setValue,u=a.clearSuggestions;return l.a.createElement("div",{className:"combobox"},l.a.createElement(D.a,{onSelect:function(){var e=Object(x.a)(O.a.mark((function e(a){var n,l,r,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(a,!1),u(),e.prev=2,e.next=5,Object(z.b)({address:a});case 5:return n=e.sent,e.next=8,Object(z.c)(n[0]);case 8:l=e.sent,r=l.lat,o=l.lng,t({lat:r,lng:o}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log("error");case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()},l.a.createElement(D.b,{className:"combobox__input",value:r,onChange:function(e){i(e.target.value)},disabled:!n,placeholder:"Enter an address"}),l.a.createElement(D.d,{className:"combobox__popover"},"OK"===s&&c.map((function(e){var t=e.id,a=e.description;return l.a.createElement(D.c,{className:"combobox__option",key:t,value:a})})))))}var A=["places"],F={width:"100%",height:"80vh"},B={lat:0,lng:0},V={styles:[{featureType:"all",elementType:"geometry.fill",stylers:[{weight:"2.00"}]},{featureType:"all",elementType:"geometry.stroke",stylers:[{color:"#9c9c9c"}]},{featureType:"all",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#eeeeee"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#7b7b7b"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#c8d7d4"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#070707"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]}],disableDefaultUI:!0,zoomControl:!0},I=Object(s.b)((function(e){return{location:e.location}}),{selectLocation:function(e){return{type:"SELECTED_LOCATION",payload:e}}})((function(e){var t=l.a.useState({}),a=Object(S.a)(t,2),n=a[0],r=a[1],o=l.a.useCallback((function(t){r({lat:t.latLng.lat(),lng:t.latLng.lng()}),e.selectLocation({lat:t.latLng.lat(),lng:t.latLng.lng()})}),[e]),s=l.a.useCallback((function(e){var t=e.lat,a=e.lng;c.current.panTo({lat:t,lng:a}),c.current.setZoom(18)}),[]),c=l.a.useRef(),i=l.a.useCallback((function(e){c.current=e}),[]),u=Object(P.c)({googleMapsApiKey:"AIzaSyDhxnT5ZQOL4A8hQaLZcAJmQqgozWhYDq4",libraries:A}),m=u.isLoaded;return u.loadError?"Error":m?l.a.createElement("div",null,l.a.createElement(M,{panTo:s}),l.a.createElement(P.a,{mapContainerStyle:F,zoom:3,center:B,options:V,onClick:o,onLoad:i},l.a.createElement(P.b,{position:{lat:n.lat,lng:n.lng}}))):"Loading..."})),R=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).clickDone=function(){e.props.onClose(),e.props.change("latitude",e.props.location.lat),e.props.change("longitude",e.props.location.lng)},e}return Object(u.a)(a,[{key:"renderBox",value:function(){return l.a.createElement("div",{className:"location-box"},l.a.createElement("h3",{className:"location-box__title"},"Location info"),l.a.createElement("div",{className:"location-box__parameter"},"Latitude:",l.a.createElement("div",{className:"location-box__parameter-value"},this.props.location.lat)),l.a.createElement("div",{className:"location-box__parameter"},"Longitude:",l.a.createElement("div",{className:"location-box__parameter-value"},this.props.location.lng)),l.a.createElement("button",{className:"location-box__button",onClick:this.clickDone},"Done"))}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,this.renderBox())}}]),a}(n.Component),U=Object(f.a)({form:"wizard",destroyOnUnmount:!1})(R),q=Object(y.a)("latitude"),H=Object(s.b)((function(e){return{latitude:q(e,"latitude"),longitude:q(e,"longitude"),location:e.location}}))(U),Q=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onClose=function(e){n.props.onClose&&n.props.onClose(e)},n.addMapValues=function(){n.props.addMapValues()},n.state={show:!0},n}return Object(u.a)(a,[{key:"render",value:function(){return this.props.show?o.a.createPortal(l.a.createElement("div",{className:"modal__background ".concat(this.props.show?"":"modal__hide")},l.a.createElement("div",{className:"modal"},l.a.createElement(I,null),l.a.createElement(H,{onClose:this.onClose}))),document.querySelector("#modal")):null}}]),a}(n.Component),W=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).manualLatLng=function(){n.setState((function(e){return{disableLatLng:!e.disableLatLng}}))},n.showModal=function(e){n.setState({show:!n.state.show})},n.nextPage=n.nextPage.bind(Object(p.a)(n)),n.previousPage=n.previousPage.bind(Object(p.a)(n)),n.state={page:1,show:!1,disableLatLng:!0},n}return Object(u.a)(a,[{key:"nextPage",value:function(){this.setState({page:this.state.page+1})}},{key:"previousPage",value:function(){this.setState({page:this.state.page-1})}},{key:"render",value:function(){var e=this.state.page;return l.a.createElement("div",null,l.a.createElement(Q,{show:this.state.show,onClose:this.showModal,addMapValues:this.addMapValues}),l.a.createElement("main",{className:"box"},l.a.createElement("h1",{className:"box__title"},"Solar power forecast"),l.a.createElement("div",null,1===e&&l.a.createElement(N,{onSubmit:this.nextPage,showModal:this.showModal,disableLatLng:this.state.disableLatLng,manualLatLng:this.manualLatLng,lat:this.props.lat,lng:this.props.lng}),2===e&&l.a.createElement(C,{previousPage:this.previousPage,onSubmit:this.onSubmit}))))}}]),a}(n.Component),X=Object(s.b)((function(e){return{lat:e.location.lat,lng:e.location.lng}}))(W),J=a(73),Y=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).daily=[],e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.sortByDay()}},{key:"sortByDay",value:function(){var e,t,a,n,l,r,o,s,c,i,u,m=new Array(7);for(m[0]="Sunday",m[1]="Monday",m[2]="Tuesday",m[3]="Wednesday",m[4]="Thursday",m[5]="Friday",m[6]="Saturday",e=0;e<this.props.forecast.length;e++)n=(a=new Date(this.props.forecast[e].period_end)).getMonth()+1,l=a.getDate(),i=("0"+(r=a.getHours())).slice(-2),u=("0"+(o=a.getMinutes())).slice(-2),s=this.props.forecast[e].pv_estimate,c={dn:m[a.getDay()],d:l,m:n,values:[{th:r,th2:i,tm:o,tm2:u,pv:s}],average:0,sum:0},this.daily[0]&&c.d===this.daily[this.daily.length-1].d?Number(c.values[0].th)>6&&Number(c.values[0].th)<20&&this.daily[this.daily.length-1].values.push(c.values[0]):this.daily.push(c);var d=0;for(e=0;e<this.daily.length;e++){for(t=1;t<this.daily[e].values.length;t++)d+=this.daily[e].values[t].pv;this.daily[e].sum=d,this.daily[e].average=d/(this.daily[e].values.length-1),d=0}for(e=0;e<this.daily.length;e++)this.daily[e].values[1]||this.daily.splice(e,1)}},{key:"renderForecast",value:function(){return this.daily.map((function(e,t){return l.a.createElement("div",{className:"forecast__box",key:t},l.a.createElement("div",{className:"forecast__col"},l.a.createElement("div",{className:"forecast__time"},e.values[1].th2,":",e.values[1].tm2," - ",e.values[e.values.length-1].th2,":",e.values[e.values.length-1].tm2),l.a.createElement("div",{className:"forecast__day"},e.dn),l.a.createElement("div",{className:"forecast__date"},e.d,".",e.m,".")),l.a.createElement("div",{className:"forecast__col"},l.a.createElement("div",{className:"forecast__col--title"},"Daily average:"),l.a.createElement("div",{className:"forecast__power"},e.average?e.average.toFixed(2):"0"," kW")))}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("main",{className:"result-box"},l.a.createElement("h1",{className:"box__title"},"Solar power forecast"),l.a.createElement("div",{className:"result-box--outer"},this.renderForecast()),l.a.createElement(J.a,{to:"/"},l.a.createElement("button",{className:"button--wide u-side-padding"},"Home"))))}}]),a}(n.Component),Z=Object(s.b)((function(e){return{forecast:Object.values(e.forecast)}}))(Y),K=a(7),G=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"outer"},l.a.createElement(K.b,{history:L},l.a.createElement(l.a.Fragment,null,l.a.createElement(K.a,{path:"/power-forecast/",exact:!0,component:X}),l.a.createElement(K.a,{path:"/power-forecast/forecast",component:Z}))))}}]),a}(n.Component),$=a(245),ee=Object(c.c)({location:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lat:0,lng:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECTED_LOCATION":return t.payload;default:return e}},form:$.a,forecast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_FORECAST":return t.payload;default:return e}}}),te=a(114),ae=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d;o.a.render(l.a.createElement(s.a,{store:Object(c.e)(ee,ae(Object(c.a)(te.a)))},l.a.createElement(G,null)),document.querySelector("#root"))}},[[116,1,2]]]);
//# sourceMappingURL=main.d909021c.chunk.js.map